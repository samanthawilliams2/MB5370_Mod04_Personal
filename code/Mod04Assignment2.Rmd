---
title: "Mod04Assignment2"
author: "Samantha Williams"
date: '2025-03-20'
output: html_document
---

#### 3.10 Assignment: End-to-end data analysis in R
This task is designed to show you how you can now take any dataset and use your skills as a marine data scientist to build impressive analyses and data visualisations that you can share with end-users.

In this assignment, we will use real-world marine data collected as part of Queensland fisheries QFISH database to develop a report (either written on your website or via an R Markdown report embedded in your website) suitable for reporting to your manager, a community group or for your own research.

# Part 1. First, obtain your data. 

Install Tidyverse
```{r}
install.packages("tidyverse")
```


```{r}
library(tidyverse)
```

```{r}
install.packages("janitor")
library(janitor)
```

```{r}
# Do this once
library(readr) # to read csv files
library(ggplot2) # to graph
library(dplyr) # data manipulation
library(tidyr)  # for tidying
```

Load CSV file & begin to clean:


```{r}
sharkdata_raw <- 
  read_csv("data/sharkdata_updated.csv") |>
  row_to_names(row_number = 2, remove_rows_above = FALSE) |> 
  clean_names()
head(sharkdata_raw)
```

# Part 2. Tidy the data


Create new tables for each species (isolate them):
```{r}
sharkdata <- 
  sharkdata_raw |>
  select(area, contains("shark")) |> # select all everything with "shark" in 'area' row
  row_to_names(row_number = 1) |> # Use the first row of this subset as the new column names
  rename(Area = 1) |>  # Capitalise the first column 
  mutate(across(-c(Area), as.numeric)) # convert all to numeric except for 'Area'
  
turtledata <-
  sharkdata_raw |>
  select(area, contains("turtle")) |>
  row_to_names(row_number = 1) |>
  rename(Area = 1) |>
  mutate(across(-c(Area), as.numeric))

mammaldata <- 
  sharkdata_raw |>
  select(area, contains("mammal")) |>
  row_to_names(row_number = 1) |>
  rename(Area = 1) |>
  mutate(across(-c(Area), as.numeric))

otherdata <-
  sharkdata_raw |>
  select(area, contains("other")) |>
  row_to_names(row_number = 1) |>
  rename(Area = 1) |>
  mutate(across(-c(Area), as.numeric))
```

Convert into long format
```{r}
sharkdata_long <- 
  sharkdata |>
  pivot_longer(!Area, names_to = "Year", values_to = "Count")

turtledata_long <- 
  turtledata |>
  pivot_longer(!Area, names_to = "Year", values_to = "Count")

mammaldata_long <-
  mammaldata |>
  pivot_longer(!Area, names_to = "Year", values_to = "Count")

otherdata_long <-
  otherdata |>
  pivot_longer(!Area, names_to = "Year", values_to = "Count")
```

Statistics - compute mean, standard deviation, and add Taxa column
```{r}
shark_stats <- 
  sharkdata_long |>
  filter(Area != "Grand Total") |>
  group_by(Year) |> 
  summarise(Mean = mean(Count, na.rm = TRUE), # Calculate Mean
            SD = sd(Count, na.rm = TRUE)) |> # Calculate Standard Deviation from the Mean
  mutate(Year = as.numeric(Year)) |>
  mutate(Taxa = "Sharks") # Adds a column for taxa 

turtle_stats <- 
  turtledata_long |>
  filter(Area != "Grand Total") |>
  group_by(Year) |>
  summarise(Mean = mean(Count, na.rm = TRUE),
            SD = sd(Count, na.rm = TRUE)) |>
  mutate(Year = as.numeric(Year)) |>
  mutate(Taxa = "Turtles")

mammal_stats <- 
  mammaldata_long |>
  filter(Area != "Grand Total") |>
  group_by(Year) |>
  summarise(Mean = mean(Count, na.rm = TRUE),
            SD = sd(Count, na.rm = TRUE)) |>
  mutate(Year = as.numeric(Year)) |>
  mutate(Taxa = "Mammals")

other_stats <-
  otherdata_long |>
  filter(Area != "Grand Total") |>
  group_by(Year) |>
  summarise(Mean = mean(Count, na.rm = TRUE),
            SD = sd(Count, na.rm = TRUE)) |>
  mutate(Year = as.numeric(Year)) |>
  mutate(Taxa = "Other")
```

Combine statitsics into one table:

```{r}
combined_stats <- 
  bind_rows(shark_stats, turtle_stats, mammal_stats, other_stats)
```


# Part 3. Add your plot and markdown report to your e-portfolio

# Due date. This component of your e-portfolio is due at the normal e-portfolio due date, the Friday following the final workshop for this module.